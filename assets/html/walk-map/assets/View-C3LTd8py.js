import{i as e,l as t,r as n,s as r,t as i}from"./index-Cl1TJMzF.js";import{At as a,Et as o,Ft as s,K as c,Q as l,Rt as u,en as d,in as f,pt as p,vt as m}from"./PlusOutlined-DpKg4S2b.js";import{t as h}from"./WalkMap-Ek39BrBx.js";function g(e,t,n){var r=n||{},i=r.noTrailing,a=i===void 0?!1:i,o=r.noLeading,s=o===void 0?!1:o,c=r.debounceMode,l=c===void 0?void 0:c,u,d=!1,f=0;function p(){u&&clearTimeout(u)}function m(e){var t=(e||{}).upcomingOnly,n=t===void 0?!1:t;p(),d=!n}function h(){var n=[...arguments],r=this,i=Date.now()-f;if(d)return;function o(){f=Date.now(),t.apply(r,n)}function c(){u=void 0}!s&&l&&!u&&o(),p(),l===void 0&&i>e?s?(f=Date.now(),a||(u=setTimeout(l?c:o,e))):o():a!==!0&&(u=setTimeout(l?c:o,l===void 0?e-i:e))}return h.cancel=m,h}function _(e,t,n){var r=(n||{}).atBegin;return g(e,t,{debounceMode:(r===void 0?!1:r)!==!1})}var v=t(r()),y=100,b=y/5,x=y/2-b/2,S=x*2*Math.PI,C=50,w=e=>{let{dotClassName:t,style:n,hasCircleCls:r}=e;return v.createElement(`circle`,{className:u(`${t}-circle`,{[`${t}-circle-bg`]:r}),r:x,cx:C,cy:C,strokeWidth:b,style:n})},T=({percent:e,prefixCls:t})=>{let n=`${t}-dot`,r=`${n}-holder`,i=`${r}-hidden`,[a,o]=v.useState(!1);d(()=>{e!==0&&o(!0)},[e!==0]);let s=Math.max(Math.min(e,100),0);if(!a)return null;let c={strokeDashoffset:`${S/4}`,strokeDasharray:`${S*s/100} ${S*(100-s)/100}`};return v.createElement(`span`,{className:u(r,`${n}-progress`,s<=0&&i)},v.createElement(`svg`,{viewBox:`0 0 ${y} ${y}`,role:`progressbar`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":s},v.createElement(w,{dotClassName:n,hasCircleCls:!0}),v.createElement(w,{dotClassName:n,style:c})))};function E(e){let{prefixCls:t,percent:n=0,className:r,style:i}=e,a=`${t}-dot`,o=`${a}-holder`,s=`${o}-hidden`;return v.createElement(v.Fragment,null,v.createElement(`span`,{className:u(o,r,n>0&&s),style:i},v.createElement(`span`,{className:u(a,`${t}-dot-spin`)},[1,2,3,4].map(e=>v.createElement(`i`,{className:`${t}-dot-item`,key:e})))),v.createElement(T,{prefixCls:t,percent:n}))}function D(e){let{prefixCls:t,indicator:n,percent:r,className:i,style:a}=e,o=`${t}-dot`;return n&&v.isValidElement(n)?c(n,e=>({className:u(e.className,o,i),style:{...e.style,...a},percent:r})):v.createElement(E,{prefixCls:t,percent:r,className:i,style:a})}var O=new a(`antSpinMove`,{to:{opacity:1}}),k=new a(`antRotate`,{to:{transform:`rotate(405deg)`}}),A=e=>{let{componentCls:t,calc:n}=e;return{[t]:{...m(e),position:`absolute`,display:`none`,color:e.colorPrimary,fontSize:0,textAlign:`center`,verticalAlign:`middle`,opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:`relative`,display:`inline-block`,opacity:1},[`${t}-text`]:{fontSize:e.fontSize,paddingTop:n(n(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:`fixed`,width:`100vw`,height:`100vh`,backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:`flex`,alignItems:`center`,flexDirection:`column`,justifyContent:`center`,opacity:0,visibility:`hidden`,transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:`visible`},[t]:{[`${t}-dot-holder`]:{color:e.colorWhite},[`${t}-text`]:{color:e.colorTextLightSolid}}},"&-nested-loading":{position:`relative`,[`> div > ${t}`]:{position:`absolute`,top:0,insetInlineStart:0,zIndex:4,display:`block`,width:`100%`,height:`100%`,maxHeight:e.contentHeight,[`${t}-dot`]:{position:`absolute`,top:`50%`,insetInlineStart:`50%`,margin:n(e.dotSize).mul(-1).div(2).equal()},[`${t}-text`]:{position:`absolute`,top:`50%`,width:`100%`,textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${t}-dot`]:{margin:n(e.dotSizeSM).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${t}-dot`]:{margin:n(e.dotSizeLG).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${t}-container`]:{position:`relative`,transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:`absolute`,top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:`100%`,height:`100%`,background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:`""`,pointerEvents:`none`}},[`${t}-blur`]:{clear:`both`,opacity:.5,userSelect:`none`,pointerEvents:`none`,"&::after":{opacity:.4,pointerEvents:`auto`}}},"&-tip":{color:e.spinDotDefault},[`${t}-dot-holder`]:{width:`1em`,height:`1em`,fontSize:e.dotSize,display:`inline-block`,transition:`transform ${e.motionDurationSlow} ease, opacity ${e.motionDurationSlow} ease`,transformOrigin:`50% 50%`,lineHeight:1,color:e.colorPrimary,"&-hidden":{transform:`scale(0.3)`,opacity:0}},[`${t}-dot-progress`]:{position:`absolute`,inset:0},[`${t}-dot`]:{position:`relative`,display:`inline-block`,fontSize:e.dotSize,width:`1em`,height:`1em`,"&-item":{position:`absolute`,display:`block`,width:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),height:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),background:`currentColor`,borderRadius:`100%`,transform:`scale(0.75)`,transformOrigin:`50% 50%`,opacity:.3,animationName:O,animationDuration:`1s`,animationIterationCount:`infinite`,animationTimingFunction:`linear`,animationDirection:`alternate`,"&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:`0s`},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:`0.4s`},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:`0.8s`},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:`1.2s`}},"&-spin":{transform:`rotate(45deg)`,animationName:k,animationDuration:`1.2s`,animationIterationCount:`infinite`,animationTimingFunction:`linear`},"&-circle":{strokeLinecap:`round`,transition:[`stroke-dashoffset`,`stroke-dasharray`,`stroke`,`stroke-width`,`opacity`].map(t=>`${t} ${e.motionDurationSlow} ease`).join(`,`),fillOpacity:0,stroke:`currentcolor`},"&-circle-bg":{stroke:e.colorFillSecondary}},[`&-sm ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeSM}},[`&-sm ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal(),height:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeLG}},[`&-lg ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${t}-show-text ${t}-text`]:{display:`block`}}}},j=p(`Spin`,e=>A(o(e,{spinDotDefault:e.colorTextDescription})),e=>{let{controlHeightLG:t,controlHeight:n}=e;return{contentHeight:400,dotSize:t/2,dotSizeSM:t*.35,dotSizeLG:n}}),M=200,N=[[30,.05],[70,.03],[96,.01]];function P(e,t){let[n,r]=v.useState(0),i=v.useRef(null),a=t===`auto`;return v.useEffect(()=>(a&&e&&(r(0),i.current=setInterval(()=>{r(e=>{let t=100-e;for(let n=0;n<N.length;n+=1){let[r,i]=N[n];if(e<=r)return e+t*i}return e})},M)),()=>{i.current&&=(clearInterval(i.current),null)}),[a,e]),a?n:t}var F;function I(e,t){return!!e&&!!t&&!Number.isNaN(Number(t))}var L=e=>{let{prefixCls:t,spinning:n=!0,delay:r=0,className:i,rootClassName:a,size:o=`default`,tip:c,wrapperClassName:d,style:f,children:p,fullscreen:m=!1,indicator:h,percent:g,classNames:y,styles:b,...x}=e,{getPrefixCls:S,direction:C,indicator:w,className:T,style:E,classNames:O,styles:k}=s(`spin`),A=S(`spin`,t),[M,N]=j(A),[L,R]=v.useState(()=>n&&!I(n,r)),z=P(L,g);v.useEffect(()=>{if(n){let e=_(r,()=>{R(!0)});return e(),()=>{e?.cancel?.()}}R(!1)},[r,n]);let B=v.useMemo(()=>p!==void 0&&!m,[p,m]),V={...e,size:o,spinning:L,tip:c,fullscreen:m,children:p,percent:z},[H,U]=l([O,y],[k,b],{props:V}),W=u(A,T,{[`${A}-sm`]:o===`small`,[`${A}-lg`]:o===`large`,[`${A}-spinning`]:L,[`${A}-show-text`]:!!c,[`${A}-rtl`]:C===`rtl`},i,!m&&a,!m&&H.root,M,N),G=u(`${A}-container`,{[`${A}-blur`]:L}),K=h??w??F,q={...E,...f},J=v.createElement(`div`,{...x,style:m?q:{...U.root,...q},className:W,"aria-live":`polite`,"aria-busy":L},v.createElement(D,{className:H.indicator,style:U.indicator,prefixCls:A,indicator:K,percent:z}),c&&(B||m)?v.createElement(`div`,{className:u(`${A}-text`,H.tip),style:U.tip},c):null);return B?v.createElement(`div`,{...x,className:u(`${A}-nested-loading`,d,H.wrapper,M,N),style:U.wrapper},L&&v.createElement(`div`,{key:`loading`},J),v.createElement(`div`,{className:G,key:`container`},p)):m?v.createElement(`div`,{className:u(`${A}-fullscreen`,{[`${A}-fullscreen-show`]:L},a,M,N,H.mask),style:U.mask},J):J};L.setDefaultIndicator=e=>{F=e};var R=L,z=i(),B=()=>{let{id:t}=e(),{walks:r}=f(),i=n(),a=(0,v.useRef)(null),[o,s]=(0,v.useState)(!1),c=r.find(e=>e.id==t);return(0,v.useEffect)(()=>{s(!1)},[t]),(0,v.useEffect)(()=>{c&&console.log(`[View页面调试] 路径数据`,{id:c.id,name:c.name,mapId:c.mapId,mapView:c.mapView,pointsCount:c.points?.length||0,points:c.points})},[c]),(0,v.useEffect)(()=>{if(c&&!o&&a.current){let e=setTimeout(()=>{a.current?.walkStart(),s(!0)},500);return()=>clearTimeout(e)}},[c,o]),c?(0,z.jsxs)(`div`,{style:{minHeight:`100vh`,backgroundColor:`#FFF8E7`,padding:`20px`},children:[(0,z.jsx)(`div`,{style:{maxWidth:`1400px`,margin:`0 auto 20px auto`,display:`flex`,justifyContent:`space-between`,alignItems:`center`,gap:`16px`},children:(0,z.jsxs)(`div`,{style:{flex:1,textAlign:`center`},children:[(0,z.jsx)(`h2`,{style:{margin:0,fontSize:`24px`,fontWeight:`600`,color:`#8B4513`},children:c.name}),c.description&&(0,z.jsx)(`p`,{style:{margin:`4px 0 0 0`,fontSize:`14px`,color:`#A0826D`},children:c.description})]})}),(0,z.jsx)(`div`,{style:{maxWidth:`1400px`,margin:`0 auto`,backgroundColor:`#FFFCF5`,borderRadius:`16px`,padding:`20px`,boxShadow:`0 2px 8px rgba(139, 69, 19, 0.08)`},children:(0,z.jsx)(h,{ref:a,mode:`view`,mapId:c.mapId,value:c.points,mapView:c.mapView,onAnimationEnd:()=>{c?.nextPathId?(console.log(`[View] 检测到 nextPathId，即将跳转到下一个路径:`,c.nextPathId),setTimeout(()=>{i(`/view/${c.nextPathId}`)},1500)):console.log(`[View] 动画播放完毕，显示结束屏`)},hasNextPath:!!c.nextPathId},c.id)})]}):(0,z.jsx)(`div`,{style:{minHeight:`100vh`,backgroundColor:`#FFF8E7`,display:`flex`,justifyContent:`center`,alignItems:`center`},children:(0,z.jsx)(R,{size:`large`,tip:`加载中...`})})};export{B as default};