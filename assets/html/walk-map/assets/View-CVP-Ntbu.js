import{c as e,o as t,r as n,t as r}from"./index-DxHQZbqU.js";import{At as i,Et as a,Ft as o,K as s,Q as c,Rt as l,en as u,in as d,pt as f,vt as p}from"./PlusOutlined-CEcXTBIy.js";import{t as m}from"./WalkMap-LkT8KSDU.js";function h(e,t,n){var r=n||{},i=r.noTrailing,a=i===void 0?!1:i,o=r.noLeading,s=o===void 0?!1:o,c=r.debounceMode,l=c===void 0?void 0:c,u,d=!1,f=0;function p(){u&&clearTimeout(u)}function m(e){var t=(e||{}).upcomingOnly,n=t===void 0?!1:t;p(),d=!n}function h(){var n=[...arguments],r=this,i=Date.now()-f;if(d)return;function o(){f=Date.now(),t.apply(r,n)}function c(){u=void 0}!s&&l&&!u&&o(),p(),l===void 0&&i>e?s?(f=Date.now(),a||(u=setTimeout(l?c:o,e))):o():a!==!0&&(u=setTimeout(l?c:o,l===void 0?e-i:e))}return h.cancel=m,h}function g(e,t,n){var r=(n||{}).atBegin;return h(e,t,{debounceMode:(r===void 0?!1:r)!==!1})}var _=e(t()),v=100,y=v/5,b=v/2-y/2,x=b*2*Math.PI,S=50,C=e=>{let{dotClassName:t,style:n,hasCircleCls:r}=e;return _.createElement(`circle`,{className:l(`${t}-circle`,{[`${t}-circle-bg`]:r}),r:b,cx:S,cy:S,strokeWidth:y,style:n})},w=({percent:e,prefixCls:t})=>{let n=`${t}-dot`,r=`${n}-holder`,i=`${r}-hidden`,[a,o]=_.useState(!1);u(()=>{e!==0&&o(!0)},[e!==0]);let s=Math.max(Math.min(e,100),0);if(!a)return null;let c={strokeDashoffset:`${x/4}`,strokeDasharray:`${x*s/100} ${x*(100-s)/100}`};return _.createElement(`span`,{className:l(r,`${n}-progress`,s<=0&&i)},_.createElement(`svg`,{viewBox:`0 0 ${v} ${v}`,role:`progressbar`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":s},_.createElement(C,{dotClassName:n,hasCircleCls:!0}),_.createElement(C,{dotClassName:n,style:c})))};function T(e){let{prefixCls:t,percent:n=0,className:r,style:i}=e,a=`${t}-dot`,o=`${a}-holder`,s=`${o}-hidden`;return _.createElement(_.Fragment,null,_.createElement(`span`,{className:l(o,r,n>0&&s),style:i},_.createElement(`span`,{className:l(a,`${t}-dot-spin`)},[1,2,3,4].map(e=>_.createElement(`i`,{className:`${t}-dot-item`,key:e})))),_.createElement(w,{prefixCls:t,percent:n}))}function E(e){let{prefixCls:t,indicator:n,percent:r,className:i,style:a}=e,o=`${t}-dot`;return n&&_.isValidElement(n)?s(n,e=>({className:l(e.className,o,i),style:{...e.style,...a},percent:r})):_.createElement(T,{prefixCls:t,percent:r,className:i,style:a})}var D=new i(`antSpinMove`,{to:{opacity:1}}),O=new i(`antRotate`,{to:{transform:`rotate(405deg)`}}),k=e=>{let{componentCls:t,calc:n}=e;return{[t]:{...p(e),position:`absolute`,display:`none`,color:e.colorPrimary,fontSize:0,textAlign:`center`,verticalAlign:`middle`,opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:`relative`,display:`inline-block`,opacity:1},[`${t}-text`]:{fontSize:e.fontSize,paddingTop:n(n(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:`fixed`,width:`100vw`,height:`100vh`,backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:`flex`,alignItems:`center`,flexDirection:`column`,justifyContent:`center`,opacity:0,visibility:`hidden`,transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:`visible`},[t]:{[`${t}-dot-holder`]:{color:e.colorWhite},[`${t}-text`]:{color:e.colorTextLightSolid}}},"&-nested-loading":{position:`relative`,[`> div > ${t}`]:{position:`absolute`,top:0,insetInlineStart:0,zIndex:4,display:`block`,width:`100%`,height:`100%`,maxHeight:e.contentHeight,[`${t}-dot`]:{position:`absolute`,top:`50%`,insetInlineStart:`50%`,margin:n(e.dotSize).mul(-1).div(2).equal()},[`${t}-text`]:{position:`absolute`,top:`50%`,width:`100%`,textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${t}-dot`]:{margin:n(e.dotSizeSM).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${t}-dot`]:{margin:n(e.dotSizeLG).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${t}-container`]:{position:`relative`,transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:`absolute`,top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:`100%`,height:`100%`,background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:`""`,pointerEvents:`none`}},[`${t}-blur`]:{clear:`both`,opacity:.5,userSelect:`none`,pointerEvents:`none`,"&::after":{opacity:.4,pointerEvents:`auto`}}},"&-tip":{color:e.spinDotDefault},[`${t}-dot-holder`]:{width:`1em`,height:`1em`,fontSize:e.dotSize,display:`inline-block`,transition:`transform ${e.motionDurationSlow} ease, opacity ${e.motionDurationSlow} ease`,transformOrigin:`50% 50%`,lineHeight:1,color:e.colorPrimary,"&-hidden":{transform:`scale(0.3)`,opacity:0}},[`${t}-dot-progress`]:{position:`absolute`,inset:0},[`${t}-dot`]:{position:`relative`,display:`inline-block`,fontSize:e.dotSize,width:`1em`,height:`1em`,"&-item":{position:`absolute`,display:`block`,width:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),height:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),background:`currentColor`,borderRadius:`100%`,transform:`scale(0.75)`,transformOrigin:`50% 50%`,opacity:.3,animationName:D,animationDuration:`1s`,animationIterationCount:`infinite`,animationTimingFunction:`linear`,animationDirection:`alternate`,"&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:`0s`},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:`0.4s`},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:`0.8s`},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:`1.2s`}},"&-spin":{transform:`rotate(45deg)`,animationName:O,animationDuration:`1.2s`,animationIterationCount:`infinite`,animationTimingFunction:`linear`},"&-circle":{strokeLinecap:`round`,transition:[`stroke-dashoffset`,`stroke-dasharray`,`stroke`,`stroke-width`,`opacity`].map(t=>`${t} ${e.motionDurationSlow} ease`).join(`,`),fillOpacity:0,stroke:`currentcolor`},"&-circle-bg":{stroke:e.colorFillSecondary}},[`&-sm ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeSM}},[`&-sm ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal(),height:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeLG}},[`&-lg ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${t}-show-text ${t}-text`]:{display:`block`}}}},A=f(`Spin`,e=>k(a(e,{spinDotDefault:e.colorTextDescription})),e=>{let{controlHeightLG:t,controlHeight:n}=e;return{contentHeight:400,dotSize:t/2,dotSizeSM:t*.35,dotSizeLG:n}}),j=200,M=[[30,.05],[70,.03],[96,.01]];function N(e,t){let[n,r]=_.useState(0),i=_.useRef(null),a=t===`auto`;return _.useEffect(()=>(a&&e&&(r(0),i.current=setInterval(()=>{r(e=>{let t=100-e;for(let n=0;n<M.length;n+=1){let[r,i]=M[n];if(e<=r)return e+t*i}return e})},j)),()=>{i.current&&=(clearInterval(i.current),null)}),[a,e]),a?n:t}var P;function F(e,t){return!!e&&!!t&&!Number.isNaN(Number(t))}var I=e=>{let{prefixCls:t,spinning:n=!0,delay:r=0,className:i,rootClassName:a,size:s=`default`,tip:u,wrapperClassName:d,style:f,children:p,fullscreen:m=!1,indicator:h,percent:v,classNames:y,styles:b,...x}=e,{getPrefixCls:S,direction:C,indicator:w,className:T,style:D,classNames:O,styles:k}=o(`spin`),j=S(`spin`,t),[M,I]=A(j),[L,R]=_.useState(()=>n&&!F(n,r)),z=N(L,v);_.useEffect(()=>{if(n){let e=g(r,()=>{R(!0)});return e(),()=>{e?.cancel?.()}}R(!1)},[r,n]);let B=_.useMemo(()=>p!==void 0&&!m,[p,m]),V={...e,size:s,spinning:L,tip:u,fullscreen:m,children:p,percent:z},[H,U]=c([O,y],[k,b],{props:V}),W=l(j,T,{[`${j}-sm`]:s===`small`,[`${j}-lg`]:s===`large`,[`${j}-spinning`]:L,[`${j}-show-text`]:!!u,[`${j}-rtl`]:C===`rtl`},i,!m&&a,!m&&H.root,M,I),G=l(`${j}-container`,{[`${j}-blur`]:L}),K=h??w??P,q={...D,...f},J=_.createElement(`div`,{...x,style:m?q:{...U.root,...q},className:W,"aria-live":`polite`,"aria-busy":L},_.createElement(E,{className:H.indicator,style:U.indicator,prefixCls:j,indicator:K,percent:z}),u&&(B||m)?_.createElement(`div`,{className:l(`${j}-text`,H.tip),style:U.tip},u):null);return B?_.createElement(`div`,{...x,className:l(`${j}-nested-loading`,d,H.wrapper,M,I),style:U.wrapper},L&&_.createElement(`div`,{key:`loading`},J),_.createElement(`div`,{className:G,key:`container`},p)):m?_.createElement(`div`,{className:l(`${j}-fullscreen`,{[`${j}-fullscreen-show`]:L},a,M,I,H.mask),style:U.mask},J):J};I.setDefaultIndicator=e=>{P=e};var L=I,R=r(),z=()=>{let{id:e}=n(),{walks:t}=d(),r=(0,_.useRef)(null),[i,a]=(0,_.useState)(!1),[o,s]=(0,_.useState)(!1),c=t.find(t=>t.id==e),l=`walk_completed_${e}`;return(0,_.useEffect)(()=>{e&&localStorage.getItem(l)===`true`&&(s(!0),console.log(`[View] æ£€æµ‹åˆ°æ­¤è·¯çº¿å·²æ’­æ”¾å®Œæ¯•`))},[e,l]),(0,_.useEffect)(()=>{c&&console.log(`[Viewé¡µé¢è°ƒè¯•] è·¯å¾„æ•°æ®`,{id:c.id,name:c.name,mapId:c.mapId,mapView:c.mapView,pointsCount:c.points?.length||0,points:c.points})},[c]),(0,_.useEffect)(()=>{if(c&&!i&&r.current){let e=setTimeout(()=>{r.current?.walkStart(),a(!0)},500);return()=>clearTimeout(e)}},[c,i]),c?o?(0,R.jsxs)(`div`,{style:{minHeight:`100vh`,backgroundColor:`#FFF8E7`,position:`relative`,display:`flex`,justifyContent:`center`,alignItems:`center`},children:[(0,R.jsx)(`div`,{style:{fontSize:`28px`,fontWeight:`500`,color:`#8B4513`,textAlign:`center`,padding:`0 20px`,lineHeight:`1.6`},children:`å“¦å“Ÿï¼Œè¿˜æƒ³çœ‹å•Šï¼Œé‚£å°±å»æ‰¾æ‰¾ç¥ç§˜é’¥åŒ™å§ğŸ˜†ğŸ˜‰`}),(0,R.jsx)(`button`,{onClick:()=>{e&&(localStorage.removeItem(l),console.log(`[View] å·²æ¸…é™¤å®Œæˆæ ‡è¯†ï¼Œåˆ·æ–°é¡µé¢`),s(!1),window.location.reload())},style:{position:`fixed`,top:0,left:0,width:`50px`,height:`50px`,backgroundColor:`transparent`,border:`none`,cursor:`pointer`,zIndex:9999,opacity:0},title:`ç‚¹å‡»é‡æ–°æ’­æ”¾`})]}):(0,R.jsxs)(`div`,{style:{minHeight:`100vh`,backgroundColor:`#FFF8E7`,padding:`20px`},children:[(0,R.jsx)(`div`,{style:{maxWidth:`1400px`,margin:`0 auto 20px auto`,display:`flex`,justifyContent:`space-between`,alignItems:`center`,gap:`16px`},children:(0,R.jsxs)(`div`,{style:{flex:1,textAlign:`center`},children:[(0,R.jsx)(`h2`,{style:{margin:0,fontSize:`24px`,fontWeight:`600`,color:`#8B4513`},children:c.name}),c.description&&(0,R.jsx)(`p`,{style:{margin:`4px 0 0 0`,fontSize:`14px`,color:`#A0826D`},children:c.description})]})}),(0,R.jsx)(`div`,{style:{maxWidth:`1400px`,margin:`0 auto`,backgroundColor:`#FFFCF5`,borderRadius:`16px`,padding:`20px`,boxShadow:`0 2px 8px rgba(139, 69, 19, 0.08)`},children:(0,R.jsx)(m,{ref:r,mode:`view`,mapId:c.mapId,value:c.points,mapView:c.mapView,onAnimationEnd:()=>{e&&(localStorage.setItem(l,`true`),console.log(`[View] åŠ¨ç”»æ’­æ”¾å®Œæ¯•ï¼Œå·²å­˜å‚¨å®Œæˆæ ‡è¯†`))}})})]}):(0,R.jsx)(`div`,{style:{minHeight:`100vh`,backgroundColor:`#FFF8E7`,display:`flex`,justifyContent:`center`,alignItems:`center`},children:(0,R.jsx)(L,{size:`large`,tip:`åŠ è½½ä¸­...`})})};export{z as default};